\chapter{Distance Measurement Evaluation}

\centering
\begin{figure}
  \begin{tikzpicture}
    \begin{axis}[width=0.9\textwidth, height=0.9\textheight,
        title={Dependency on CLBeacon's \acs{RSSI} and accuracy properties.},
        xlabel={\acs{RSSI} (dBm)},
        ylabel={Accuracy (m)},
        legend entries={accuracy, avg. accuracy, $d = 10^{-\frac{RSSI + 65}{10 * 2.1}}$},
      grid = major,
      x dir=reverse, ymin=0]
      \addplot [only marks, mark=x] table[col sep=semicolon, x=rssi, y=accuracy] {csv/2014-10-15_hoehenweg/all.csv};
      \addplot [red, mark=triangle*, mark size=3pt] table[col sep=semicolon, x=rssi, y=avgAccuracy] {csv/2014-10-15_hoehenweg/all_avg_accuracy_per_rssi.csv};
      \addplot[blue, domain=-55:-95, samples=100]{10^(-(x+65)/(10*2.1))};
  \end{axis}
\end{tikzpicture}
\caption {According to \cite{BPos_RSSI-Triangulation}, the distance $d$, between an iBeacon and a smartphone, which depends on the \acl{RSS}, can be calculated with the formula $d = 10^{-\frac{RSSI + A}{10 * n}}$, where $A$ is the \acs{RSSI} value at a distance of 1m and the environmental constant $n$. The iBeacon's calibration value was set to 65dBm, thus $A = 65dBmm$. $n = 2.1$ to approximate the measurements best.  The measurements where taken outdoor with \ac{LOS} between iBeacon and smartphone. For each reference distance 60 \ac{RSSI} and accuracy values where measured.}
\end{figure}


\centering
\begin{figure}
  \begin{tikzpicture}
    \begin{axis}[trim axis left, trim axis right, width=0.9\textwidth, height=0.9\textheight,
        title={Dispersion of CLBeacon's accuracy property.},
        xlabel={Reference distance (m)},
        ylabel={Accuracy (m)},
      legend entries={accuracy, avg. accuracy},
      grid = major]
      \addplot [only marks, mark=x] table[col sep=semicolon, x=proximityRef, y=accuracy] {csv/2014-10-15_hoehenweg/all.csv};
      \addplot [red, only marks, mark=triangle*, mark size=3pt] table[col sep=semicolon, x=proximityRef, y=avgAccuracy] {csv/2014-10-15_hoehenweg/avg_all.csv};
      \addplot [black, dashed, domain=0:30, samples=2]{x};
  \end{axis}
\end{tikzpicture}
\caption {Measurement curicumstances: The measurements where taken outdoor with \ac{LOS} between iBeacon and smartphone. For each reference distance 60 accuracy values where measured.}
\end{figure}


\centering
\begin{figure}
  \begin{tikzpicture}
    \begin{axis}[trim axis left, trim axis right, width=0.9\textwidth, height=0.9\textheight,
        title={Normal Distribution Function parameters},
        xlabel={Mean $\mu$ (m)},
        ylabel={Standard deviation $\sigma$ (m)},
        legend entries={outdoor (LOS), $f(\mu)=0.3286 \cdot \mu + 0.8379$, indoor (HTWG-KN F007), $f(\mu)=0.3131 \cdot \mu + 0.0051$},
      grid = major]
      \addplot [red, mark=*] table[col sep=semicolon, x=mu_distance, y=sigma_distance] {csv/2014-10-15_hoehenweg/ndf_parameters.csv};
      \addplot [red, dashed, domain=0:30, samples=2]{0.3286*x+0.8379};
      \addplot [blue, mark=*] table[col sep=semicolon, x=mu_distance, y=sigma_distance] {csv/2014-10-27_htwg_f007/ndf_parameters.csv};
      \addplot [blue, dashed, domain=0:30, samples=2]{0.3131*x+0.0051};
  \end{axis}
\end{tikzpicture}
\caption {Measurement curicumstances: The measurements where taken outdoor with \ac{LOS} between iBeacon and smartphone. For each reference distance 60 accuracy values where measured.}
\end{figure}


\centering
\begin{figure}
  \begin{tikzpicture}
    \begin{axis}[width=0.9\textwidth, height=0.9\textheight,
        title={Dispersion of CLBeacon's accuracy property.},
        xlabel={Reference distance (m)},
        ylabel={Accuracy (m)},
      legend entries={accuracy, avg. accuracy},
      grid = major]
      \addplot [only marks, mark=x] table[col sep=semicolon, x=proximityRef, y=accuracy] {csv/2014-10-15_htwg_keller_f/all.csv};
      \addplot [red, only marks, mark=triangle*, mark size=3pt] table[col sep=semicolon, x=proximityRef, y=avgAccuracy] {csv/2014-10-15_htwg_keller_f/all_avg_accuracy_per_proximity.csv};
      \addplot [black, dashed, domain=0:30, samples=2]{x};
  \end{axis}
\end{tikzpicture}
\caption {Measurement curicumstances: The measurements where taken indoor (HTWG Konstanz F building cellar) with \ac{LOS} between iBeacon and smartphone. For each reference distance 60 accuracy values where measured.}
\end{figure}

\centering
\begin{figure}
  \begin{tikzpicture}
    \begin{axis}[width=0.9\textwidth, height=0.9\textheight,
        title={Dispersion of CLBeacon's accuracy property.},
        xlabel={Reference distance (m)},
        ylabel={Accuracy (m)},
      legend entries={accuracy, avg. accuracy},
      grid = major]
      \addplot [only marks, mark=x] table[col sep=semicolon, x=proximityRef, y=accuracy] {csv/2014-10-27_htwg_f007/all.csv};
      \addplot [red, only marks, mark=triangle*, mark size=3pt] table[col sep=semicolon, x=proximityRef, y=avgAccuracy] {csv/2014-10-27_htwg_f007/all_avg_accuracy_per_proximity.csv};
      \addplot [black, dashed, domain=0:14.5, samples=2]{x};
  \end{axis}
\end{tikzpicture}
\caption {Measurement curicumstances: The measurements where taken indoor (HTWG Konstanz F007) with \ac{LOS} between iBeacon and smartphone. For each reference distance 60 accuracy values where measured.}
\end{figure}

\centering
\begin{figure}
  \begin{tikzpicture}
    \begin{axis}[width=0.9\textwidth, height=0.9\textheight,
      xlabel={Time (sec)},
      axis y line*=left,
    ylabel={Accuracy (m)}]
      %legend entries={accuracy, distance, RSSI}]
      \addplot [blue, mark=x] table[col sep=semicolon, x=time, y=accuracy] {csv/2014-10-27_htwg_f007/04_2m.csv};
      \addlegendentry{accuracy}
      %\addplot [blue, only marks, mark=x] table[col sep=semicolon, x=time, y=accuracy] {csv/2014-10-27_htwg_f007/06_4m.csv};
      \addplot [black, dashed, domain=0:59, samples=2]{2};\label{distance}
      \addlegendentry{distance}
      %\addplot [blue, dashed, domain=0:59, samples=2]{4};
  \end{axis}
  \pgfplotsset{every axis y label/.append style={rotate=180, yshift=15cm}}
  \begin{axis}[width=0.9\textwidth, height=0.9\textheight,
    axis y line*=right,
    ylabel={RSSI (dBm)},
    hide x axis,
    y dir=reverse]
    \addlegendimage{/pgfplots/refstyle=distance}\addlegendentry{RSSI}
    \addplot [red, mark=*] table[col sep=semicolon, x=time, y=rssi] {csv/2014-10-27_htwg_f007/04_2m.csv};
    %\addplot [blue, only marks, mark=x] table[col sep=semicolon, x=time, y=rssi] {csv/2014-10-27_htwg_f007/06_4m.csv};
  \end{axis}
\end{tikzpicture}
\caption {Measurement curicumstances: The measurements where taken indoor (HTWG Konstanz F007) with \ac{LOS} between iBeacon and smartphone. For each reference distance 60 accuracy values where measured.}
\end{figure}

\begin{figure}
\centering
  \subfloat[Average \acs{RSSI} in different situations]{
  \begin{tikzpicture}
    \begin{axis}[width=0.45\textwidth, height=0.4\textheight,
        title={Average \acs{RSSI} in different situations},
        xlabel={Situation},
        ylabel={RSSI (dBm)},
        y dir=reverse,
      grid = major]
      \addplot [only marks, mark=*] table[col sep=semicolon, x=measurement, y=rssi] {csv/2014-10-27_htwg_fk034_angles/all_avg.csv};
  \end{axis}
\end{tikzpicture}
}
  \subfloat[Average accuracy in different situations]{
  \begin{tikzpicture}
    \begin{axis}[width=0.45\textwidth, height=0.4\textheight,
        title={Average accuracy in different situations},
        xlabel={Situation},
        ylabel={Accuracy (m)},
      grid = major]
      \addplot [only marks, mark=*] table[col sep=semicolon, x=measurement, y=accuracy] {csv/2014-10-27_htwg_fk034_angles/all_avg.csv};
  \end{axis}
\end{tikzpicture}
}

\caption {Measurement curicumstances: The measurements where taken indoor (HTWG Konstanz FK034) with a distance of 1 m between iBeacon and smartphone. For each situation 60-100 values where measured.\\
  Situations:
  \emph{(1)} iPhone (horizontal) in front of Beacon (vertical) with \acs{LOS}.
  \emph{(2)} iPhone (horizontal) sideways with \acs{LOS} to  Beacon (vertical).
  \emph{(3)} iPhone (horzontal) below Beacon (vertical) with angle of 45 degree and \acs{LOS}.
  \emph{(4)} iPhone (vertical) in front of Beacon (vertical) with \acs{LOS}.
  \emph{(5)} iPhone (horizontal) in front of Beacon (horizontal) with \acs{LOS}.
  \emph{(6)} iPhone (horizontal) in front of Beacon (vertical) with person in between.
  \emph{(7)} iPhone (horizontal, backwards) in front of Beacon (vertical) with \acs{LOS}.
  \emph{(8)} iPhone (horizontal, backwards) in front of Beacon (vertical) with person in between.
  \emph{(9)} iPhone (horizontal) in front of Beacon (vertical) with 30 cm ferro concrete wall in between.
}
\end{figure}

