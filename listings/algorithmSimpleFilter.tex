\begin{lstlisting}[
  float,
  floatplacement=P,
  mathescape,
  captionpos=b,
  caption={Helper function for the \acs{PF}'s importance factoring and resampling.},
  label=lst:algorithmSimpleFilter]
filter($\chi_{t-1}$, $z_t$, map) {

  $\bar{\chi}_t = \emptyset$

  // importance factoring
  for $m = 1$ to $M$ {
    $w^{[m]}_t$ = measurement_model($z_t$,$x^{[m]}_t$, map)
    add $\langle x^{[m]}_t, w^{[m]}_t \rangle$ to $\bar{\chi}_t$
  }

  $\chi_t = \emptyset$

  \\ resampling
  while size of $\chi_t$ less $M$ {
    draw $i$ with probability $\propto w^{[m]}_t$
    add $x^{[i]}_t$ to $\chi_t$
  }

  return $\chi_t$
}return\end{lstlisting}
